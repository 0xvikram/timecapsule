// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Note: For Prisma 7+, connection URLs should be in prisma.config.ts
// For Prisma 5/6, use the datasource block below

generator client {
  provider = "prisma-client-js"
}

// Uncomment when ready to connect to database
// datasource db {
//   provider = "postgresql"
//   url      = env("DATABASE_URL")
// }

// For now, using localStorage. When database is ready:
// 1. Uncomment the datasource block above
// 2. Run: npx prisma migrate dev --name init
// 3. Run: npx prisma generate

model User {
  id        String    @id @default(cuid())
  email     String?   @unique
  username  String?   @unique
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  capsules  Capsule[]
}

model Capsule {
  id          String   @id @default(cuid())
  title       String
  description String
  unlockDate  DateTime
  isPublic    Boolean  @default(true)
  status      String   @default("locked") // locked | unlocked

  userId String
  user   User   @relation(fields: [userId], references: [id], onDelete: Cascade)

  goals Goal[]

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Goal {
  id           String @id @default(cuid())
  text         String
  expectedDate String // Format: YYYY-MM
  status       String @default("pending") // pending | in-progress | completed

  capsuleId String
  capsule   Capsule @relation(fields: [capsuleId], references: [id], onDelete: Cascade)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
